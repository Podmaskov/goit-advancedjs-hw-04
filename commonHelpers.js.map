{"version":3,"file":"commonHelpers.js","sources":["../src/api.js","../src/gallery.js"],"sourcesContent":["import axios from 'axios';\nconst API_KEY = '2573416-853329f61ff5a3b6beba25569';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nconst fetchPictures = axios.create({\n  baseURL: BASE_URL,\n  timeout: 10000,\n});\n\nexport async function getPictures({ searchQuery, page }) {\n  const data = await fetchPictures.get('/', {\n    params: {\n      key: API_KEY,\n      q: searchQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: 40,\n    },\n  });\n  return data.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport iziToast from 'izitoast';\nimport { getPictures } from './api';\n\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst TOAST_DEFAULT_OPTIONS = {\n  position: 'topRight',\n  messageColor: '#fff',\n};\n\nconst formElement = document.querySelector('.search-form');\nconst galleryWrapElement = document.querySelector('.gallery');\nconst loaderElement = document.querySelector('.loader');\n\nlet searchQuery = '';\nlet totalPictures = 0;\nlet page = 1;\n\nformElement.addEventListener('submit', async event => {\n  event.preventDefault();\n  const inputValue = event.target.elements.searchQuery.value\n    .toLowerCase()\n    .trim();\n\n  if (!inputValue) return;\n  searchQuery = inputValue;\n  page = 1;\n  event.target.elements.searchQuery.value = '';\n  galleryWrapElement.innerHTML = '';\n  loaderElement.classList.remove('hide');\n  try {\n    const { hits: pictures, total } = await getPictures({ searchQuery, page });\n    if (!pictures.length) {\n      iziToast.show({\n        ...TOAST_DEFAULT_OPTIONS,\n        message: `We're sorry, but images to your request didn't find.`,\n        color: '#ef5350',\n      });\n    }\n    totalPictures = total;\n    renderGallery(createListOfPictures(pictures), true);\n    iziToast.show({\n      ...TOAST_DEFAULT_OPTIONS,\n      message: `Hooray! We found ${totalPictures} images.`,\n      color: '#7dc67d',\n    });\n  } catch (error) {\n    console.error('Error!!!!', error);\n  } finally {\n    loaderElement.classList.add('hide');\n  }\n});\n\nfunction renderGallery(picturesTemplate, isNewSearch = false) {\n  if (galleryWrapElement.lastElementChild) {\n    io.unobserve(galleryWrapElement.lastElementChild);\n  }\n  isNewSearch\n    ? (galleryWrapElement.innerHTML = picturesTemplate)\n    : galleryWrapElement.insertAdjacentHTML('beforeend', picturesTemplate);\n\n  io.observe(galleryWrapElement.lastElementChild);\n  new SimpleLightbox('.gallery a', {\n    captionSelector: 'img',\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n\nfunction createListOfPictures(pictures) {\n  return pictures\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n        <li class=\"photo-card\">\n          <a href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" height=\"220\" />\n            </a>\n            <div class=\"info\">\n              <p class=\"info-item\"><b>Likes</b> ${likes}</p>\n              <p class=\"info-item\"><b>Views</b> ${views}</p>\n              <p class=\"info-item\"><b>Comments</b> ${comments}</p>\n              <p class=\"info-item\"><b>Downloads</b> ${downloads}</p>\n            </div>\n        </li>\n  `\n    )\n    .join('');\n}\n\nasync function loadNextPictures() {\n  page += 1;\n  const { hits: pictures } = await getPictures({ searchQuery, page });\n  return pictures;\n}\n\nconst io = new IntersectionObserver(async entries => {\n  const picturesRendered = galleryWrapElement.childElementCount;\n  if (entries[0].intersectionRatio <= 0 || picturesRendered === totalPictures) {\n    return;\n  }\n  try {\n    const pictures = await loadNextPictures();\n    renderGallery(createListOfPictures(pictures));\n  } catch (error) {\n    console.error('observer error', error);\n  }\n});\n"],"names":["API_KEY","BASE_URL","fetchPictures","axios","getPictures","searchQuery","page","TOAST_DEFAULT_OPTIONS","formElement","galleryWrapElement","loaderElement","totalPictures","event","inputValue","pictures","total","iziToast","renderGallery","createListOfPictures","error","picturesTemplate","isNewSearch","io","SimpleLightbox","webformatURL","largeImageURL","tags","likes","views","comments","downloads","loadNextPictures","entries","picturesRendered"],"mappings":"owBACA,MAAMA,EAAU,oCACVC,EAAW,2BAEXC,EAAgBC,EAAM,OAAO,CACjC,QAASF,EACT,QAAS,GACX,CAAC,EAEM,eAAeG,EAAY,CAAE,YAAAC,EAAa,KAAAC,GAAQ,CAYvD,OAXa,MAAMJ,EAAc,IAAI,IAAK,CACxC,OAAQ,CACN,IAAKF,EACL,EAAGK,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAU,EACX,CACL,CAAG,GACW,IACd,CCfA,MAAMC,EAAwB,CAC5B,SAAU,WACV,aAAc,MAChB,EAEMC,EAAc,SAAS,cAAc,cAAc,EACnDC,EAAqB,SAAS,cAAc,UAAU,EACtDC,EAAgB,SAAS,cAAc,SAAS,EAEtD,IAAIL,EAAc,GACdM,EAAgB,EAChBL,EAAO,EAEXE,EAAY,iBAAiB,SAAU,MAAMI,GAAS,CACpDA,EAAM,eAAc,EACpB,MAAMC,EAAaD,EAAM,OAAO,SAAS,YAAY,MAClD,YAAa,EACb,OAEH,GAAKC,EACL,CAAAR,EAAcQ,EACdP,EAAO,EACPM,EAAM,OAAO,SAAS,YAAY,MAAQ,GAC1CH,EAAmB,UAAY,GAC/BC,EAAc,UAAU,OAAO,MAAM,EACrC,GAAI,CACF,KAAM,CAAE,KAAMI,EAAU,MAAAC,CAAO,EAAG,MAAMX,EAAY,CAAE,YAAAC,EAAa,KAAAC,CAAI,CAAE,EACpEQ,EAAS,QACZE,EAAS,KAAK,CACZ,GAAGT,EACH,QAAS,uDACT,MAAO,SACf,CAAO,EAEHI,EAAgBI,EAChBE,EAAcC,EAAqBJ,CAAQ,EAAG,EAAI,EAClDE,EAAS,KAAK,CACZ,GAAGT,EACH,QAAS,oBAAoBI,YAC7B,MAAO,SACb,CAAK,CACF,OAAQQ,EAAP,CACA,QAAQ,MAAM,YAAaA,CAAK,CACpC,QAAY,CACRT,EAAc,UAAU,IAAI,MAAM,CACnC,EACH,CAAC,EAED,SAASO,EAAcG,EAAkBC,EAAc,GAAO,CACxDZ,EAAmB,kBACrBa,EAAG,UAAUb,EAAmB,gBAAgB,EAElDY,EACKZ,EAAmB,UAAYW,EAChCX,EAAmB,mBAAmB,YAAaW,CAAgB,EAEvEE,EAAG,QAAQb,EAAmB,gBAAgB,EAC9C,IAAIc,EAAe,aAAc,CAC/B,gBAAiB,MACjB,aAAc,MACd,aAAc,GAClB,CAAG,CACH,CAEA,SAASL,EAAqBJ,EAAU,CACtC,OAAOA,EACJ,IACC,CAAC,CACC,aAAAU,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA,qBAESL;AAAA,wBACGD,WAAsBE;AAAA;AAAA;AAAA,kDAGIC;AAAA,kDACAC;AAAA,qDACGC;AAAA,sDACCC;AAAA;AAAA;AAAA,GAIjD,EACA,KAAK,EAAE,CACZ,CAEA,eAAeC,GAAmB,CAChCzB,GAAQ,EACR,KAAM,CAAE,KAAMQ,GAAa,MAAMV,EAAY,CAAE,YAAAC,EAAa,KAAAC,CAAI,CAAE,EAClE,OAAOQ,CACT,CAEA,MAAMQ,EAAK,IAAI,qBAAqB,MAAMU,GAAW,CACnD,MAAMC,EAAmBxB,EAAmB,kBAC5C,GAAI,EAAAuB,EAAQ,GAAG,mBAAqB,GAAKC,IAAqBtB,GAG9D,GAAI,CACF,MAAMG,EAAW,MAAMiB,IACvBd,EAAcC,EAAqBJ,CAAQ,CAAC,CAC7C,OAAQK,EAAP,CACA,QAAQ,MAAM,iBAAkBA,CAAK,CACtC,CACH,CAAC"}